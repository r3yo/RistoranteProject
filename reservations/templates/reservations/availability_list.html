{% extends "base.html" %}
{% load static %}

{% block title %}Available Tables{% endblock %}

{% block content %}
    <div class="container mt-5">
        <h2 class="mb-4 text-center">Available Tables</h2>

        {% if tables_with_availability %}
            <!-- Sorting -->
            <div class="row g-3 mb-4 justify-content-start">
                <div class="col-md-3 col-sm-6 ">
                    <label for="sortTable" class="form-label fw-bold">Sort By:</label>
                    <select id="sortTable" class="form-select form-select-sm rounded-pill">
                        <option value="number">Table Number</option>
                        <option value="seats">Seats</option>
                        <option value="slots">Free Slots</option>
                    </select>
                </div>
            </div>

            <div class="list-group" id="availability-list">
                {% for item in tables_with_availability %}
                    <div class="list-group-item d-flex flex-column align-items-start mb-2"
                        data-table="{{ item.table.number }}"
                        data-seats="{{ item.table.seats }}"
                        data-slots="{{ item.hours|length }}">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-1">Table {{ item.table.number }} ({{ item.table.seats }} seats)</h5>
                        </div>
                        <p class="mb-0">
                            Available hours: 
                            {% for h, label in item.hours %}
                                {{ label }}{% if not forloop.last %}; {% endif %}
                            {% endfor %}
                        </p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-center text-muted">No available tables</p>
        {% endif %}
    </div>

    <script src="{% static 'reservations/js/availability_sort.js' %}"></script>
{% endblock %}